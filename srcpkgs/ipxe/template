# Template file for 'ipxe'
pkgname=ipxe
version=1.21.1.20230111
revision=1
_commit=ab19546386b13d6c54aea1647fac06960c544efc
build_style=gnu-makefile
make_use_env=yes
restricted="No, but THIS PACKAGE MUST NEVER BE MERGED TO VOID PACKAGES"
build_wrksrc=src
make_build_args="EMBED=undionly.ipxe"
make_build_target="bin/undionly.kpxe"
hostmakedepends="perl"
makedepends="liblzma-devel"
short_desc="Open Source Boot Firmware"
maintainer="Toyam Cox <Vaelatern@voidlinux.org>"
license="GPL-2.0-only"
homepage="https://ipxe.org/"
distfiles="https://github.com/ipxe/ipxe/archive/${_commit}.tar.gz"
checksum=b61964de4f771884c823b16fe9b8b42403edc7d09a51e1b18a3f6e53f8266bfa

pre_build() {
	cp "${FILESDIR}/undionly.ipxe" undionly.ipxe
}

do_install() {
	vmkdir usr/share/ipxe
	vinstall bin/undionly.kpxe 444 usr/share/ipxe
}
